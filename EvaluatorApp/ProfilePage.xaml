<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:ios="clr-namespace:Microsoft.Maui.Controls.PlatformConfiguration.iOSSpecific;assembly=Microsoft.Maui.Controls"
             x:Class="EvaluatorApp.ProfilePage"
             Title="Perfil"
             Shell.NavBarIsVisible="False"
             ios:Page.UseSafeArea="False"
             BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundLight}, Dark={StaticResource BackgroundDark}}">

    <ScrollView VerticalScrollBarVisibility="Never">
        <VerticalStackLayout Padding="16,0,16,24" Spacing="24">

            <!-- Profile Header -->
            <VerticalStackLayout Spacing="16" Margin="0,20,0,0">
                <Grid HorizontalOptions="Center" WidthRequest="128" HeightRequest="128">
                    <Grid.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnProfileImageClicked"/>
                    </Grid.GestureRecognizers>
                    <Border Stroke="{AppThemeBinding Light=White, Dark={StaticResource SurfaceDark}}"
                            StrokeThickness="4"
                            StrokeShape="RoundRectangle 64"
                            HeightRequest="128"
                            WidthRequest="128"
                            HorizontalOptions="Center"
                            Padding="0">
                        <Border.Shadow>
                            <Shadow Brush="Black" Offset="0,4" Opacity="0.1" Radius="10"/>
                        </Border.Shadow>
                        <Image x:Name="ProfileImage"
                               Source="https://res.cloudinary.com/djwpi6z29/image/upload/v1770699551/avatar-default-user-profile-icon-social-media-vector-57234208_y8gtgs.jpg"
                               Aspect="AspectFill"
                               HeightRequest="120"
                               WidthRequest="120"
                               HorizontalOptions="Center"
                               VerticalOptions="Center">
                               <Image.Clip>
                                   <EllipseGeometry Center="60,60" RadiusX="60" RadiusY="60"/>
                               </Image.Clip>
                        </Image>
                    </Border>
                    
                    <!-- Camera Icon Badge -->
                    <Border Stroke="{AppThemeBinding Light={StaticResource Gray100}, Dark={StaticResource Gray900}}"
                            StrokeThickness="1"
                            BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
                            StrokeShape="RoundRectangle 20"
                            HeightRequest="32"
                            WidthRequest="32"
                            HorizontalOptions="End"
                            VerticalOptions="End"
                            Margin="0,0,4,4">
                        <Border.Shadow>
                             <Shadow Brush="Black" Offset="0,2" Opacity="0.1" Radius="4"/>
                        </Border.Shadow>
                        <Label Text="photo_camera" 
                               FontFamily="MaterialIcons"
                               FontSize="18"
                               TextColor="{StaticResource Primary}"
                               HorizontalOptions="Center"
                               VerticalOptions="Center"/>
                    </Border>
                </Grid>

                <VerticalStackLayout Spacing="4" HorizontalOptions="Center">
                    <Label x:Name="NameLabel"
                           Text="Cargando..."
                           FontSize="24"
                           FontAttributes="Bold"
                           TextColor="{AppThemeBinding Light={StaticResource TextPrimary}, Dark=White}"
                           HorizontalOptions="Center"/>
                    
                    <HorizontalStackLayout Spacing="8" HorizontalOptions="Center">
                        <Border Stroke="#33135bec"
                                StrokeThickness="1"
                                BackgroundColor="#1A135bec"
                                StrokeShape="RoundRectangle 10"
                                Padding="10,2">
                            <Label x:Name="RoleLabel"
                                   Text="Evaluador"
                                   FontSize="12"
                                   FontAttributes="Bold"
                                   TextColor="{AppThemeBinding Light={StaticResource Primary}, Dark=#93c5fd}"/>
                        </Border>
                        
                        <Label x:Name="EmailLabel"
                               Text="..."
                               FontSize="14"
                               TextColor="{AppThemeBinding Light={StaticResource TextSecondary}, Dark={StaticResource TextSubDark}}"
                               VerticalOptions="Center"/>
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </VerticalStackLayout>

            <!-- Section: Cuenta -->
            <VerticalStackLayout Spacing="8">
                <Label Text="CUENTA"
                       Padding="16,0,0,0"
                       FontSize="12"
                       FontAttributes="Bold"
                       TextColor="{AppThemeBinding Light={StaticResource TextSecondary}, Dark={StaticResource TextSubDark}}"/>

                <Border StrokeThickness="1"
                        Stroke="{AppThemeBinding Light=#0D111827, Dark=#1AFFFFFF}"
                        BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
                        StrokeShape="RoundRectangle 16">
                    <Border.Shadow>
                        <Shadow Brush="Black" Offset="0,1" Opacity="0.05" Radius="2"/>
                    </Border.Shadow>
                    
                    <VerticalStackLayout Spacing="0">
                        <!-- Edit Profile -->
                        <Grid Padding="16" ColumnDefinitions="Auto,*,Auto" ColumnSpacing="16">
                            <Grid.GestureRecognizers>
                                <TapGestureRecognizer Tapped="OnEditProfileClicked"/>
                            </Grid.GestureRecognizers>
                            
                            <Border Grid.Column="0" 
                                    StrokeThickness="0"
                                    WidthRequest="40"
                                    HeightRequest="40"
                                    StrokeShape="RoundRectangle 10"
                                    BackgroundColor="{AppThemeBinding Light=#eff6ff, Dark=#331e3a8a}">
                                <Label Text="person_edit"
                                       FontFamily="MaterialIcons"
                                       FontSize="24"
                                       TextColor="{AppThemeBinding Light={StaticResource Primary}, Dark=#60a5fa}"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"/>
                            </Border>
                            
                            <Label Grid.Column="1" 
                                   Text="Editar Perfil"
                                   FontSize="16"
                                   FontAttributes="Bold"
                                   VerticalOptions="Center"
                                   TextColor="{AppThemeBinding Light={StaticResource TextPrimary}, Dark=White}"/>
                            
                            <Label Grid.Column="2"
                                   Text="arrow_forward_ios"
                                   FontFamily="MaterialIcons"
                                   FontSize="20"
                                   VerticalOptions="Center"
                                   TextColor="{AppThemeBinding Light={StaticResource Gray400}, Dark={StaticResource Gray600}}"/>
                        </Grid>

                        <BoxView HeightRequest="1" Color="{AppThemeBinding Light={StaticResource Gray100}, Dark={StaticResource Gray900}}" Margin="64,0,0,0"/>

                        <!-- Change Password -->
                        <Grid Padding="16" ColumnDefinitions="Auto,*,Auto" ColumnSpacing="16">
                            <Grid.GestureRecognizers>
                                <TapGestureRecognizer Tapped="OnChangePasswordClicked"/>
                            </Grid.GestureRecognizers>

                            <Border Grid.Column="0" 
                                    StrokeThickness="0"
                                    WidthRequest="40"
                                    HeightRequest="40"
                                    StrokeShape="RoundRectangle 10"
                                    BackgroundColor="{AppThemeBinding Light=#eff6ff, Dark=#331e3a8a}">
                                <Label Text="lock_reset"
                                       FontFamily="MaterialIcons"
                                       FontSize="24"
                                       TextColor="{AppThemeBinding Light={StaticResource Primary}, Dark=#60a5fa}"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"/>
                            </Border>

                            <Label Grid.Column="1" 
                                   Text="Cambiar Contraseña"
                                   FontSize="16"
                                   FontAttributes="Bold"
                                   VerticalOptions="Center"
                                   TextColor="{AppThemeBinding Light={StaticResource TextPrimary}, Dark=White}"/>

                            <Label Grid.Column="2"
                                   Text="arrow_forward_ios"
                                   FontFamily="MaterialIcons"
                                   FontSize="20"
                                   VerticalOptions="Center"
                                   TextColor="{AppThemeBinding Light={StaticResource Gray400}, Dark={StaticResource Gray600}}"/>
                        </Grid>
                    </VerticalStackLayout>
                </Border>
            </VerticalStackLayout>

            <!-- Section: General -->
            <VerticalStackLayout Spacing="8">
                <Label Text="GENERAL"
                       Padding="16,0,0,0"
                       FontSize="12"
                       FontAttributes="Bold"
                       TextColor="{AppThemeBinding Light={StaticResource TextSecondary}, Dark={StaticResource TextSubDark}}"/>

                <Border StrokeThickness="1"
                        Stroke="{AppThemeBinding Light=#0D111827, Dark=#1AFFFFFF}"
                        BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
                        StrokeShape="RoundRectangle 16">
                    <Border.Shadow>
                        <Shadow Brush="Black" Offset="0,1" Opacity="0.05" Radius="2"/>
                    </Border.Shadow>

                    <VerticalStackLayout Spacing="0">
                        <!-- Notifications -->
                        <Grid Padding="16" ColumnDefinitions="Auto,*,Auto" ColumnSpacing="16">
                            
                            <Border Grid.Column="0" 
                                    StrokeThickness="0"
                                    WidthRequest="40"
                                    HeightRequest="40"
                                    StrokeShape="RoundRectangle 10"
                                    BackgroundColor="{AppThemeBinding Light=#fff7ed, Dark=#337c2d12}">
                                <Label Text="notifications"
                                       FontFamily="MaterialIcons"
                                       FontSize="24"
                                       TextColor="{AppThemeBinding Light=#f97316, Dark=#fb923c}"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"/>
                            </Border>

                            <Label Grid.Column="1" 
                                   Text="Notificaciones"
                                   FontSize="16"
                                   FontAttributes="Bold"
                                   VerticalOptions="Center"
                                   TextColor="{AppThemeBinding Light={StaticResource TextPrimary}, Dark=White}"/>

                            <Switch Grid.Column="2" IsToggled="True" OnColor="{StaticResource Primary}"/>
                        </Grid>

                        <BoxView HeightRequest="1" Color="{AppThemeBinding Light={StaticResource Gray100}, Dark={StaticResource Gray900}}" Margin="64,0,0,0"/>

                        <!-- Dark Mode Toggle -->
                        <Grid Padding="16" ColumnDefinitions="Auto,*,Auto" ColumnSpacing="16">
                            
                            <Border Grid.Column="0" 
                                    StrokeThickness="0"
                                    WidthRequest="40"
                                    HeightRequest="40"
                                    StrokeShape="RoundRectangle 10"
                                    BackgroundColor="{AppThemeBinding Light=#f0f4ff, Dark=#33312e81}">
                                <Label Text="dark_mode"
                                       FontFamily="MaterialIcons"
                                       FontSize="24"
                                       TextColor="{AppThemeBinding Light=#6366f1, Dark=#818cf8}"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"/>
                            </Border>

                            <Label Grid.Column="1" 
                                   Text="Modo Oscuro"
                                   FontSize="16"
                                   FontAttributes="Bold"
                                   VerticalOptions="Center"
                                   TextColor="{AppThemeBinding Light={StaticResource TextPrimary}, Dark=White}"/>

                            <Switch x:Name="DarkModeSwitch" 
                                    Grid.Column="2" 
                                    OnColor="{StaticResource Primary}"
                                    Toggled="OnDarkModeToggled"/>
                        </Grid>

                        <BoxView HeightRequest="1" Color="{AppThemeBinding Light={StaticResource Gray100}, Dark={StaticResource Gray900}}" Margin="64,0,0,0"/>

                        <!-- Help & Support -->
                        <Grid Padding="16" ColumnDefinitions="Auto,*,Auto" ColumnSpacing="16">
                            <Grid.GestureRecognizers>
                                <TapGestureRecognizer Tapped="OnHelpClicked"/>
                            </Grid.GestureRecognizers>

                            <Border Grid.Column="0" 
                                    StrokeThickness="0"
                                    WidthRequest="40"
                                    HeightRequest="40"
                                    StrokeShape="RoundRectangle 10"
                                    BackgroundColor="{AppThemeBinding Light=#faf5ff, Dark=#33581c87}">
                                <Label Text="help"
                                       FontFamily="MaterialIcons"
                                       FontSize="24"
                                       TextColor="{AppThemeBinding Light=#a855f7, Dark=#c084fc}"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"/>
                            </Border>

                            <Label Grid.Column="1" 
                                   Text="Ayuda y Soporte"
                                   FontSize="16"
                                   FontAttributes="Bold"
                                   VerticalOptions="Center"
                                   TextColor="{AppThemeBinding Light={StaticResource TextPrimary}, Dark=White}"/>

                            <Label Grid.Column="2"
                                   Text="arrow_forward_ios"
                                   FontFamily="MaterialIcons"
                                   FontSize="20"
                                   VerticalOptions="Center"
                                   TextColor="{AppThemeBinding Light={StaticResource Gray400}, Dark={StaticResource Gray600}}"/>
                        </Grid>
                    </VerticalStackLayout>
                </Border>
            </VerticalStackLayout>

            <!-- Section: Logout -->
            <VerticalStackLayout Spacing="24">
                <Border StrokeThickness="1"
                        Stroke="{AppThemeBinding Light=#0D111827, Dark=#1AFFFFFF}"
                        BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
                        StrokeShape="RoundRectangle 16"
                        Padding="16"
                        HeightRequest="56">
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnLogoutClicked"/>
                    </Border.GestureRecognizers>
                    <Border.Shadow>
                        <Shadow Brush="Black" Offset="0,1" Opacity="0.05" Radius="2"/>
                    </Border.Shadow>
                    
                    <HorizontalStackLayout Spacing="8" HorizontalOptions="Center" VerticalOptions="Center">
                        <Label Text="logout"
                               FontFamily="MaterialIcons"
                               FontSize="20"
                               TextColor="#ef4444"
                               VerticalOptions="Center"/>
                        <Label Text="Cerrar Sesión"
                               FontSize="16"
                               FontAttributes="Bold"
                               TextColor="#ef4444"
                               VerticalOptions="Center"/>
                    </HorizontalStackLayout>
                </Border>

                <Label Text="Versión 1.0.2 • Build 2023.10"
                       FontSize="12"
                       TextColor="{AppThemeBinding Light={StaticResource TextSecondary}, Dark={StaticResource TextSubDark}}"
                       HorizontalOptions="Center"/>
            </VerticalStackLayout>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
